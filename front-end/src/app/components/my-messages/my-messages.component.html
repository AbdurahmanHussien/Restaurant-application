<div class="container mx-auto py-6 mt-20">
  <div class="flex justify-between items-center mb-8">

  <h2 class="text-2xl font-bold">My Messages</h2>
</div>
  <!-- Error Box -->
  <div *ngIf="errorMessage" class=" absolute mr-auto justify-center justify-self-center items-center flex py-3 px-4 left-1/2 transform -translate-x-1/2 bg-red-100 border border-red-300 text-red-800  rounded-lg shadow-lg min-w-96 z-50  gap-2">
    <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.054 0 1.918-.816 1.994-1.851L21 18V6a2 2 0 00-1.851-1.995L19 4H5a2 2 0 00-1.995 1.851L3 6v12c0 1.054.816 1.918 1.851 1.994L5 20z"/>
    </svg>
    <span class="text-sm font-medium">{{ errorMessage }}</span>
  </div>

  <!-- Contacts Loop -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

  <div *ngFor="let contact of contactList" class="bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col justify-between">

    <div>
      <h3 class="text-lg font-semibold text-gray-800">{{ contact.name }}</h3>
      <p class="text-gray-600 text-sm mb-4">{{ contact.message }}</p>

      <!-- No Replies Message -->
      <div *ngIf="contact.comments?.length === 0"
           class="h-[200px] flex items-center justify-center bg-gray-50 rounded-lg border border-gray-200 text-gray-500 text-sm font-medium">
        No replies
      </div>

      <!-- Replies -->
      <div *ngIf="contact.comments?.length > 0"
           class="bg-gray-50 p-3 rounded-lg border border-gray-200 max-h-[200px] overflow-y-auto comment-scroll space-y-2">

        <h4 class="text-sm font-medium text-gray-700 mb-2">Replies</h4>

        <div *ngFor="let c of contact.comments.slice().reverse()">
          <div class="flex justify-between items-center bg-white border border-gray-300 px-4 py-2 rounded-md shadow-sm text-sm">
            <div>
              <span class="font-semibold text-gray-800">{{ c.username }}</span>
              <span class="text-gray-700">: {{ c.value }}</span>
            </div>
            <div class="flex items-center space-x-2">
              <time class="text-xs text-gray-500">{{ c.createdDate | timeago }}</time>

              <button *ngIf="c.username === currentUser"
                      class="text-red-500 hover:text-red-700 text-sm"
                      (click)="deleteComment(c.id)">
                <i class="fas fa-trash"></i>
              </button>

            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Reply Box -->
    <div class="mt-5">
      <button
        class="text-xs bg-[#ff6600] hover:bg-[#e65c00] text-white px-4 py-2 rounded-md"
        (click)="openReplyBox(contact)">
        Reply
      </button>

      <div *ngIf="selectedContact?.id === contact.id" class="mt-3">
        <textarea [(ngModel)]="replyValue" rows="3"
                  class="w-full p-3 border border-gray-300 rounded-md text-sm resize-none focus:outline-none focus:ring-2 focus:ring-[#ff6600]"
                  placeholder="Write your reply..."></textarea>
        <button
          class="mt-2 bg-[#ff6600] hover:bg-[#e65c00] text-white px-4 py-2 rounded-md text-xs"
          (click)="submitReply(contact.id)">
          Send
        </button>
      </div>
    </div>

  </div>
    </div>
</div>
